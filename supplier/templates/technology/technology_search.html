{% extends 'base.html' %}
{% load humanize %}

{% block title %}{{block.super}}: Поиск поставщика технологий{% endblock %}

{% block content %}
{% if select_except %}
<div class='ms-5 mt-5'>
    <h5 class='text-danger'>ВНИМАНИЕ! Поставщиков по категории <span class="text-primary">"{{product}}"</span> не
        найдено.</h5>
    <p>{{select_except}}</p>
    <a href="{% url 'technology_selection' %}">Вернуться к форме выбора</a>
</div>
{% else %}

{% if items %}
<div class="col-12 mx-auto margin-mb100">
    <a href="{% url 'technology_selection' %}">Вернуться к выбору</a>
    <h3>Поставщики технологий по категории "{{product}}".</h3>
    <span><b>Всего поставщиков: {{items.count|intcomma}}.</b></span>
    <i>Для получения подробной информации о поставщике кликните на наименование поставщика.</i>

    <table class="table table-striped demotable">
        <thead style="position: sticky; top: -1px; z-index:1; background: #9d9e9e; font-size:14px">
            <tr>
                <th scope="col">Поставщик</th>
                <th scope="col">Страна</th>
                <th scope="col" class="d-none d-md-table-cell">Категория</th>
                <th scope="col" class="d-none d-md-table-cell">Контакты</th>
                {% if language == 'en' %}
                <th scope="col" class="d-none d-lg-table-cell">Technology</th>
                {% else %}
                <th scope="col" class="d-none d-lg-table-cell">Технология</th>
                {% endif %}
            </tr>
        </thead>
        <tbody style="font-size:12px">
            {% for item in items %}
            <tr>
                <th><a href="{% url 'technology_detail' item.pk %}" target="_blank">{{ item.name }}</a></th>
                <td>{{ item.country }}</td>
                <td class="d-none d-md-table-cell">{{ item.category }}</td>
                <td class="d-none d-md-table-cell">{{ item.contact|slice:":255" }}</td>
                {% if language == 'en' %}
                <td class='text-danger data_no d-none d-lg-table-cell'>{{ item.product|slice:":255" }}</td>
                {% else %}
                <td class='text-danger data_no d-none d-lg-table-cell'>{{ item.product_ru|slice:":255" }}</td>
                {% endif %}
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% else %}
<div class="row mt-2 margin-mb100">
    <div class="col-lg-12">
        <div class="card1">
            <div class="card-body">
                <div class="card-body">
                    <h4>Поиск поставщиков технологий</h4>
                    {% if available_message %}
                    <div class="text-danger">{{ available_message }} <a class="fw-bold"
                            href="{% url 'bank_cleaning:subscription_list' %}">Оформите подписку</a></div>
                    {% else %}
                    Доступно поисков: {{ available_count }}
                    {% endif %}
                </div>
                <div class="card-body">
                    <form action="#" method="post" novalidate="novalidate">
                        {% csrf_token %}
                        <div class="form-group">
                            <p>
                                <label for="name" class="control-label mt-4"><b>Технология</b></label>
                                <br>{{ form.category_technology }}
                                {% if form.category_technology.errors %}
                            <div class="text-danger">{{ form.category_technology.errors }}</div>
                            {% endif %}
                            <p>
                                <label for="name" class="control-label"><b>Страна</b></label>
                                <br>{{ form.country }}
                            </p>

                            <label for="name" class="control-label mt-3 mb-1"><b>Выбрать язык поиска</b></label>
                            {{ form.language }}
                            </p>

                            {% if user.is_authenticated %}
                            <button type="submit" class="btn bg-blue1 bg-hover1 color-button-text btn-block mb-4">
                                <span>Искать поставщика</span>
                            </button>
                            {% endif %}

                            <hr>
                            <p>Для информации:</p>
                            <p>
                                <label for="name" class="control-label mb-1 color-blue1"><b>Страны с благоприятным
                                        режимом ВЭД</b></label>
                                <span>{{ form.country_demo_a }}</span><br>
                                <label for="name" class="control-label mb-1 color-second-text"><b>Страны с особым
                                        режимом ВЭД</b></label>
                                <span>{{ form.country_demo_b }}</span>
                            </p>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
{% endif %}
{% endif %}
{% endblock content %}